# 要件定義書

## プロジェクト概要（入力）

ゲーム開始中のUI視認性改善（APIモード）：
- **問題1**: ゲーム開始中のUI要素が見づらい（アクティブプレイヤー表示、タイマー表示、コントロールボタン等）
- **問題2**: 非アクティブプレイヤーのカードの輪郭がわかりづらい（カード間の境界が不明瞭）
- **目的**: APIモード（通常モード）でゲーム進行中のUI視認性を向上させ、ユーザーがゲーム状態を容易に把握できるようにする
- **スコープ**: ゲーム開始後（activePlayerIndex !== -1）のUI要素のスタイリング改善
- **対象コンポーネント**: PlayerList.tsx、GameTimer.tsx（APIモードセクション）
- **アクセシビリティ**: WCAG 2.1 AAレベル（コントラスト比4.5:1以上）の遵守

## 要件

### 機能要件

#### FR1: アクティブプレイヤー表示の視認性向上

**FR1.1: アクティブプレイヤー名の強調表示**
- **WHEN** ゲーム進行中（activePlayerIndex !== -1）である場合
- **THEN** GameTimerコンポーネントは、アクティブプレイヤー名を高コントラストで表示しなければならない
- **優先度**: 必須
- **検証条件**: アクティブプレイヤー名のテキストが背景に対して4.5:1以上のコントラスト比を持つこと

**FR1.2: アクティブプレイヤーカードの視覚的強調**
- **WHEN** ゲーム進行中である場合
- **THEN** PlayerListコンポーネントは、アクティブプレイヤーのカードを明確に強調表示しなければならない
- **優先度**: 必須
- **検証条件**: アクティブプレイヤーカードが他のカードと視覚的に区別可能であること

#### FR2: 非アクティブプレイヤーカードの輪郭明確化

**FR2.1: カード境界の視覚的区別**
- **WHEN** 複数のプレイヤーカードが表示されている場合
- **THEN** PlayerListコンポーネントは、各カード間の境界を明確に表示しなければならない
- **優先度**: 必須
- **検証条件**: 各プレイヤーカードが独立した視覚的要素として認識可能であること

**FR2.2: 非アクティブカードの輪郭スタイル**
- **WHEN** プレイヤーカードが非アクティブ状態である場合
- **THEN** PlayerListコンポーネントは、カードに明確な輪郭線を適用しなければならない
- **優先度**: 必須
- **検証条件**: 輪郭線が背景に対して十分なコントラストを持つこと

#### FR3: タイマー表示の視認性向上

**FR3.1: タイマー数値の高コントラスト表示**
- **WHEN** ゲーム進行中である場合
- **THEN** GameTimerコンポーネントは、タイマー数値を高コントラストで表示しなければならない
- **優先度**: 必須
- **検証条件**: タイマー数値が背景に対して4.5:1以上のコントラスト比を持つこと

**FR3.2: ターン時間表示の視認性**
- **WHEN** ゲーム進行中である場合
- **THEN** GameTimerコンポーネントは、ターン時間（"turn-time"要素）を明確に表示しなければならない
- **優先度**: 必須
- **検証条件**: ターン時間表示が視覚的に識別可能であること

#### FR4: コントロールボタンの視認性向上

**FR4.1: ボタンラベルの高コントラスト表示**
- **WHEN** ゲーム進行中である場合
- **THEN** GameTimerコンポーネントは、全てのコントロールボタン（一時停止、再開、リセット、ターン切り替え等）のラベルを高コントラストで表示しなければならない
- **優先度**: 必須
- **検証条件**: 全てのボタンラベルが背景に対して4.5:1以上のコントラスト比を持つこと

**FR4.2: ボタン無効状態の視覚的表現**
- **WHEN** ボタンが無効状態（disabled）である場合
- **THEN** GameTimerコンポーネントは、無効状態を視覚的に明確に表示しなければならない
- **優先度**: 推奨
- **検証条件**: 無効状態のボタンが有効状態のボタンと視覚的に区別可能であること

### 非機能要件

#### NFR1: アクセシビリティ

**NFR1.1: WCAG 2.1 AAレベル準拠**
- **WHERE** 全てのUI要素が表示される場合
- **THE SYSTEM** は、WCAG 2.1 AAレベルのアクセシビリティ基準を満たさなければならない
- **優先度**: 必須
- **検証条件**: 全てのテキスト要素が背景に対して4.5:1以上のコントラスト比を持つこと

**NFR1.2: 色のみに依存しない情報伝達**
- **WHERE** ゲーム状態が視覚的に表示される場合
- **THE SYSTEM** は、色のみに依存せず、形状や配置でも情報を伝達しなければならない
- **優先度**: 推奨
- **検証条件**: 色覚異常を持つユーザーでも情報を認識可能であること

#### NFR2: 視覚的一貫性

**NFR2.1: デザイン言語の統一**
- **WHERE** スタイリング変更が適用される場合
- **THE SYSTEM** は、既存のデザイン言語との一貫性を保たなければならない
- **優先度**: 推奨
- **検証条件**: 新しいスタイルが既存のUIパターンと調和していること

**NFR2.2: レスポンシブ対応**
- **WHERE** 異なる画面サイズで表示される場合
- **THE SYSTEM** は、全ての画面サイズで視認性を維持しなければならない
- **優先度**: 推奨
- **検証条件**: モバイル、タブレット、デスクトップの全てで視認性が確保されること

#### NFR3: パフォーマンス

**NFR3.1: スタイリング変更のパフォーマンス影響**
- **WHERE** スタイリング変更が適用される場合
- **THE SYSTEM** は、レンダリングパフォーマンスに悪影響を与えてはならない
- **優先度**: 推奨
- **検証条件**: スタイリング変更後もフレームレートが60fps以上を維持すること

### 制約条件

#### C1: 対象範囲

**C1.1: APIモード限定**
- スタイリング改善は、APIモード（通常モード）のUI要素のみを対象とする
- フォールバックモードのUI要素は、この仕様の対象外とする

**C1.2: ゲーム進行中のみ**
- スタイリング改善は、ゲーム開始後（activePlayerIndex !== -1）のUI要素のみを対象とする
- ゲーム開始前のUI要素は、この仕様の対象外とする

#### C2: 対象コンポーネント

**C2.1: PlayerList.tsx**
- プレイヤーカードの輪郭、境界の視覚的改善が対象

**C2.2: GameTimer.tsx（APIモードセクション）**
- アクティブプレイヤー表示、タイマー表示、コントロールボタンの視覚的改善が対象

### 受け入れ基準

#### AC1: アクティブプレイヤー表示

- [ ] ゲーム進行中にアクティブプレイヤー名が明確に識別可能
- [ ] アクティブプレイヤーカードが他のカードと視覚的に区別可能
- [ ] コントラスト比が4.5:1以上であることを自動テストで検証

#### AC2: プレイヤーカードの境界

- [ ] 全てのプレイヤーカードが独立した視覚的要素として認識可能
- [ ] カード間の境界が明確に表示される
- [ ] 非アクティブカードに明確な輪郭線が適用される

#### AC3: タイマーとコントロールボタン

- [ ] タイマー数値が明確に識別可能
- [ ] ターン時間表示が視覚的に識別可能
- [ ] 全てのコントロールボタンラベルが明確に識別可能
- [ ] コントラスト比が4.5:1以上であることを自動テストで検証

#### AC4: アクセシビリティ

- [ ] WCAG 2.1 AAレベルのアクセシビリティ基準を満たす
- [ ] 色覚異常を持つユーザーでも情報を認識可能
- [ ] スクリーンリーダーでの利用に支障がない

#### AC5: パフォーマンスと一貫性

- [ ] スタイリング変更がレンダリングパフォーマンスに悪影響を与えない
- [ ] 既存のデザイン言語との一貫性が保たれる
- [ ] 全ての画面サイズで視認性が確保される
