# 実装タスク

## Phase 1: セクション分割とレイアウト基盤（Requirement 1）

### 1. 操作頻度別のボタンセクション分割を実装する

- [x] 1.1 主要操作セクションを実装する
  - 頻繁に使用する操作（一時停止/再開）を配置する領域を作成
  - 一時停止状態に応じてボタンラベルを「一時停止」⇔「再開」に切り替える機能を実装
  - ボタンクリック時に一時停止/再開切り替え機能を実装
  - data-testid属性を設定してテスト・アクセシビリティツールで識別可能にする
  - _Requirements: 1.2_

- [x] 1.2 設定・その他セクションを実装する
  - 低頻度の設定変更操作（プレイヤー人数、カウントモード、リセット）を配置する領域を作成
  - リセットボタン機能を統合（全プレイヤー経過時間0秒、アクティブプレイヤーnull、一時停止false）
  - カウントモードに応じてカウントダウン設定UIの表示/非表示を制御
  - ゲーム進行中は設定変更操作を無効化
  - data-testid属性を設定してテスト・アクセシビリティツールで識別可能にする
  - _Requirements: 1.3_

- [x] 1.3 セクション境界の視覚的区切りを実装する
  - 主要操作セクションと設定・その他セクションを明確に分離する視覚要素を実装
  - 境界線、余白、背景色などで2セクションを区別
  - モバイル（375px〜767px）では縦方向に積み重ねて配置
  - タブレット・PC（768px以上）では横方向または最適なレイアウトで配置
  - _Requirements: 1.1, 1.4, 1.5, 1.6_

## Phase 2: 固定ヘッダー実装（Requirement 2）

### 2. 現在プレイヤー情報の画面上部固定表示を実装する

- [x] 2.1 固定ヘッダー領域を実装する
  - 画面最上部に固定表示されるヘッダー領域を作成
  - スクロール時も常に画面上部に表示される機能を実装（position: sticky）
  - 「次のプレイヤーへ」ボタンを固定ヘッダー内に配置
  - 現在のアクティブプレイヤー名と経過時間を表示
  - アクティブプレイヤーがいない場合は「ゲーム未開始」状態を表示
  - data-testid属性を設定してテスト・アクセシビリティツールで識別可能にする
  - _Requirements: 2.1, 2.2, 2.3_

- [x] 2.2 固定ヘッダーの動的更新機能を実装する
  - アクティブプレイヤー変更時にヘッダー内のプレイヤー名と時間を即座に更新
  - タイマー動作中は経過時間を1秒ごとに更新
  - 「次のプレイヤーへ」ボタンクリック時のプレイヤー切り替え機能を実装
  - _Requirements: 2.4, 2.5_

- [x] 2.3 固定ヘッダーのレスポンシブレイアウトを実装する
  - モバイル（375px）では情報を縦方向または最適なレイアウトで配置
  - タブレット・PC（768px以上）では情報を横方向に配置
  - 全画面幅でボタンと情報が適切に表示され操作可能にする
  - _Requirements: 2.6, 2.7_

## Phase 3: プレイヤー人数ドロップダウン実装（Requirement 3）

### 3. プレイヤー人数選択のドロップダウン化を実装する

- [x] 3.1 プレイヤー人数ドロップダウンUIを実装する
  - 4人、5人、6人から選択できるドロップダウンコントロールを作成
  - ドロップダウンを開いた際に選択肢を表示
  - アクセシビリティ対応（aria-label、キーボードナビゲーション、data-testid）
  - _Requirements: 3.1, 3.2, 5.2, 5.3, 5.4_

- [x] 3.2 プレイヤー人数変更機能を実装する
  - ドロップダウンから人数を選択した際にプレイヤー数を即座に変更
  - 既存のプレイヤー時間データを保持し、追加プレイヤーは初期状態で表示
  - ゲーム進行中（タイマー動作中）はプレイヤー人数変更を無効化
  - _Requirements: 3.3, 3.4, 3.5_

## Phase 4: カウントモードトグルスイッチ実装（Requirement 4）

### 4. カウントモード切替のトグルスイッチUI化を実装する

- [x] 4.1 カウントモードトグルスイッチUIを実装する
  - カウントアップ/カウントダウンの2状態を視覚的に表現するトグルスイッチを作成
  - スイッチの位置と色で状態を区別
  - ホバー時の視覚的フィードバック（色変化、影等）を実装
  - アクセシビリティ対応（aria-label、キーボード操作、data-testid）
  - _Requirements: 4.1, 4.2, 4.7, 5.2, 5.3, 5.4_

- [x] 4.2 カウントモード切替機能を実装する
  - トグルスイッチクリック時にカウントモードを即座に切り替え
  - カウントアップ時はトグルを「カウントアップ」位置に表示し、カウントダウン設定UIを非表示
  - カウントダウン時はトグルを「カウントダウン」位置に表示し、カウントダウン設定UIを表示
  - ゲーム進行中（タイマー動作中）はカウントモード切替を無効化
  - _Requirements: 4.3, 4.4, 4.5, 4.6_

## Phase 5: GameTimer統合（Requirements 1-4統合）

### 5. 既存GameTimerコンポーネントに新規UIコンポーネントを統合する

- [ ] 5.1 GameTimerコンポーネントの構造を改修する
  - 固定ヘッダーをGameTimerの最上部に配置
  - 主要操作セクションを固定ヘッダーの下に配置
  - 設定・その他セクションを主要操作セクションの下に配置
  - プレイヤー人数ドロップダウンとカウントモードトグルスイッチを設定セクションに統合
  - 既存の「次のプレイヤーへ」ボタンを固定ヘッダーに移動
  - _Requirements: 1.2, 1.3, 2.2_

- [ ] 5.2 useGameStateフックとの連携を実装する
  - useGameStateフックのインターフェースを変更せずに新規コンポーネントと連携
  - 固定ヘッダーがuseGameStateから現在のアクティブプレイヤー情報を取得
  - プレイヤー人数ドロップダウンがuseGameStateのプレイヤー数変更機能と連携
  - カウントモードトグルスイッチがuseGameStateのタイマーモード変更機能と連携
  - プレイヤー一覧とTopTimePlayerIndicatorとの統合を維持
  - _Requirements: 全Requirements統合_

## Phase 6: レスポンシブUIとアクセシビリティ実装（Requirement 5）

### 6. レスポンシブUIとアクセシビリティを実装する

- [ ] 6.1 レスポンシブレイアウトを実装する
  - 375px〜767px（モバイル）: セクションを縦方向に積み重ね、固定ヘッダーは縦並び
  - 768px〜1023px（タブレット）: セクションを横方向に配置、固定ヘッダーは横並び
  - 1024px〜1440px+（PC）: セクションを最適なレイアウトで配置、固定ヘッダーは横並び
  - 375px〜1440px以上の任意の画面幅で全てのUIコントロールを適切に表示し操作可能にする
  - メディアクエリを使用して画面幅に応じた自動調整を実装
  - _Requirements: 5.1, 1.5, 1.6, 2.6, 2.7_

- [ ] 6.2 アクセシビリティとタップターゲットサイズを実装する
  - 全てのインタラクティブ要素（ドロップダウン、トグルスイッチ、ボタン）にdata-testid属性を設定
  - キーボード操作対応（適切なフォーカス管理とTab順序）を実装
  - ドロップダウンとトグルスイッチに適切なARIAラベルとロール属性を設定
  - タッチデバイス向けに全てのタップターゲットを44px以上のサイズで表示
  - トグルスイッチのホバー時視覚的フィードバックを実装
  - _Requirements: 5.2, 5.3, 5.4, 5.5, 4.7_

## Phase 7: テスト実装

### 7. 単体テスト、統合テスト、E2Eテストを実装する

- [ ] 7.1 UIコンポーネントの単体テストを実装する
  - プレイヤー人数ドロップダウンのテスト（選択肢表示、選択変更、無効化状態、アクセシビリティ）
  - カウントモードトグルスイッチのテスト（状態表示、切替動作、無効化状態、ホバー、アクセシビリティ）
  - 固定ヘッダーのテスト（プレイヤー情報表示、ボタン動作、未開始状態、レスポンシブレイアウト）
  - 主要操作セクションのテスト（ボタンラベル切替、動作確認）
  - 設定セクションのテスト（子コンポーネント配置、条件付き表示、無効化制御）
  - _Requirements: Testing Strategy - Unit Tests_

- [ ] 7.2 GameTimer統合テストを実装する
  - 固定ヘッダーとuseGameStateの連携テスト（アクティブプレイヤー変更時の更新）
  - プレイヤー人数ドロップダウンとuseGameStateの連携テスト（人数変更時の状態更新）
  - カウントモードトグルスイッチとuseGameStateの連携テスト（モード切替時の状態更新とUI反映）
  - セクション分割の視覚的検証（境界線表示確認）
  - レスポンシブレイアウトの統合検証（375px、768px、1024px、1440pxでの表示確認）
  - _Requirements: Testing Strategy - Integration Tests_

- [ ] 7.3 E2Eテストを実装する
  - プレイヤー人数変更フロー（ドロップダウン選択→リスト更新→データ保持確認）
  - カウントモード切替フロー（トグル→設定UI表示/非表示→再トグル確認）
  - 固定ヘッダー動作フロー（スクロール→固定表示確認→ボタンクリック→情報更新確認）
  - ゲーム進行中の無効化フロー（タイマー開始→設定無効化→一時停止→設定有効化確認）
  - レスポンシブUI検証（375px/768px/1024px/1440pxでレイアウト確認、タップターゲットサイズ確認）
  - _Requirements: Testing Strategy - E2E Tests_

## Phase 8: Chrome DevTools検証（必須）

### 8. 実機検証とタスク完了処理を実施する

- [ ] 8.1 Chrome DevTools MCPを使用した実機検証を実施する
  - 開発サーバー起動後、Chrome DevToolsでアプリケーションにアクセス
  - 初期状態スナップショットを取得
  - プレイヤー人数ドロップダウン操作と状態変化を確認（スナップショット取得）
  - カウントモードトグルスイッチ操作と状態変化を確認（スナップショット取得）
  - 固定ヘッダーの「次のプレイヤーへ」ボタン動作を確認（スナップショット取得）
  - 一時停止ボタン動作を確認（スナップショット取得）
  - ページスクロール時の固定ヘッダー表示を確認（スナップショット取得）
  - レスポンシブUI検証（375px/768px/1024px/1440pxでレイアウト確認）
  - アクセシビリティ検証（ARIA属性、キーボードナビゲーション確認）
  - 全ての単体テストが成功していることを確認
  - エラーや予期しない動作が発生しないことを確認
  - _Requirements: Design - フロントエンド実装の検証プロセス_

- [ ] 8.2 タスク完了処理とコミット作成を実施する
  - tasks.mdの全タスクをチェック済み`[x]`に更新
  - 詳細なコミットメッセージを作成（実装内容、テスト結果、Chrome DevTools検証結果を含む）
  - 即座にGitコミットを作成（複数タスクをまとめない）
  - spec.jsonのphaseを"implementation-done"に更新
  - _Requirements: Design - フロントエンド実装の検証プロセス_
