# 実装タスク: reset-button-fix

## Phase 1: コード修正

- [ ] 1. リセット時の一時停止フラグを正しく設定する
- [ ] 1.1 ゲーム状態リセット関数の一時停止フラグを修正
  - ゲーム状態管理フック内のリセット関数を特定
  - 一時停止フラグの設定値を`false`から`true`に変更
  - この修正によりタイマー停止条件が満たされるようになる
  - 既存のタイマー制御ロジックは変更不要（停止条件ロジックを再利用）
  - _Requirements: 1.3, 2.1, 2.2, 2.3_

## Phase 2: ユニットテスト

- [ ] 2. リセット機能のユニットテストを作成・実行する
- [ ] 2.1 ゲーム状態リセット関数のテスト作成
  - リセット後の一時停止フラグが`true`であることを検証
  - リセット後のアクティブプレイヤーIDが`null`であることを検証
  - カウントアップモードでのプレイヤー時間リセットを検証（全プレイヤーが0秒）
  - カウントダウンモードでのプレイヤー時間リセットを検証（全プレイヤーが初期時間）
  - 全プレイヤーのアクティブ状態フラグが`false`であることを検証
  - _Requirements: 1.1, 1.2, 1.3, 1.4, 1.5, 1.6_

- [ ] 2.2 タイマー停止ロジックのテスト作成
  - 一時停止フラグが`true`の場合にタイマーが停止することを検証
  - アクティブプレイヤーIDが`null`の場合にタイマーが停止することを検証
  - タイマーインターバルが正しくクリアされることを確認
  - _Requirements: 2.1, 2.2, 2.3_

- [ ] 2.3 全ユニットテスト実行と検証
  - `npm test`で全ユニットテストを実行
  - 新規テストと既存テストの全てがパスすることを確認
  - テスト結果をコンソールで確認し、リグレッションがないことを確認
  - _Requirements: All_

## Phase 3: E2Eテスト

- [ ] 3. リセット機能のE2Eテストを作成・実行する
- [ ] 3.1 リセットボタン押下後のUI状態検証テスト作成
  - リセットボタンを押下する操作を自動化
  - 全プレイヤーの時間表示がリセット値になることを検証（カウントアップ: 「00:00」、カウントダウン: 初期時間）
  - アクティブプレイヤーのハイライト表示が削除されることを検証
  - 一時停止/再開ボタンが「一時停止」状態を表示することを検証
  - ゲーム全体のプレイ時間表示が「00:00」であることを検証
  - _Requirements: 3.1, 3.2, 3.3, 3.4_

- [ ] 3.2 リセット後のタイマー停止検証テスト作成
  - リセット実行後、5秒間待機する処理を追加
  - プレイヤーの時間表示が変化しないことを検証（タイマーが停止していることを確認）
  - タイマーが動作していないことを確認するための待機時間を設定
  - _Requirements: 2.1, 2.2_

- [ ] 3.3 リセット後の新規ゲーム開始検証テスト作成
  - リセット実行後、次のプレイヤーへボタンを押下する操作を自動化
  - アクティブプレイヤーが正しく設定されることを検証
  - タイマーが開始されることを検証（時間が増加することを確認）
  - 新規ゲームが正常に開始できることを確認
  - _Requirements: 1.2, 2.3_

- [ ] 3.4 プレイヤー名履歴保存の検証テスト作成
  - プレイヤー名を変更してゲームを開始する操作を自動化
  - リセットボタンを押下する操作を自動化
  - ページを再読み込みする処理を追加
  - プレイヤー名履歴にカスタム名が保存されていることを検証
  - _Requirements: 4.1_

- [ ] 3.5 全E2Eテスト実行と検証
  - `npx playwright test`で全E2Eテストを実行
  - 新規テストと既存テストの全てがパスすることを確認
  - テスト結果をレポートで確認し、リグレッションがないことを確認
  - _Requirements: All_

## Phase 4: 実装完了処理

- [ ] 4. 実装完了処理を実施する
- [ ] 4.1 全テスト結果の確認
  - 全てのユニットテストが成功していることを確認
  - 全てのE2Eテストが成功していることを確認
  - エラーや予期しない動作が発生しないことを確認
  - パフォーマンステスト要件を満たしていることを確認（リセット処理100ms以内、タイマー即座停止）
  - _Requirements: All_

- [ ] 4.2 spec.json更新とコミット作成
  - spec.jsonのphaseを"implementation-done"に更新
  - tasks.mdの全タスクをチェック済み[x]に更新
  - 詳細なコミットメッセージを作成（実装内容、テスト結果含む）
  - Gitコミット作成（実装完了の最終コミット）
  - _Requirements: All_
