# Requirements Document

## はじめに

本機能は、既存のマルチプレイヤーゲームタイマーのプレイヤー人数設定範囲を拡張します。現在4-6人に制限されているプレイヤー人数を2-6人に変更し、2人または3人でもゲームを楽しめるようにします。これにより、少人数でのゲームプレイが可能になり、より幅広い利用シーンに対応できます。

## Requirements

### 要件1: プレイヤー人数選択範囲の拡張
**目的:** ゲーム利用者として、2人または3人でもゲームをプレイできるようにすることで、少人数でのゲーム利用を可能にする

#### 受入基準
1. WHERE プレイヤー人数選択ドロップダウン THE ゲームタイマーは 2人、3人、4人、5人、6人の選択肢を表示すること
2. WHEN プレイヤー人数として2人を選択 THEN ゲームタイマーは 2人のプレイヤーでゲームを開始できること
3. WHEN プレイヤー人数として3人を選択 THEN ゲームタイマーは 3人のプレイヤーでゲームを開始できること
4. WHEN プレイヤー人数として4人、5人、6人を選択 THEN ゲームタイマーは 既存の動作を維持すること
5. WHERE 初期表示時 THE ゲームタイマーは デフォルトで4人を選択状態で表示すること

### 要件2: プレイヤー表示とレイアウトの適応
**目的:** ゲーム利用者として、選択したプレイヤー人数に応じた適切なUIレイアウトで表示されることで、視認性の高いゲーム体験を得る

#### 受入基準
1. WHEN プレイヤー人数が2人の場合 THEN ゲームタイマーは 2人分のプレイヤーカードのみを表示すること
2. WHEN プレイヤー人数が3人の場合 THEN ゲームタイマーは 3人分のプレイヤーカードのみを表示すること
3. WHEN プレイヤー人数を変更 THEN ゲームタイマーは 新しいプレイヤー人数に応じてプレイヤーカードの表示数を即座に更新すること
4. WHERE 各プレイヤーカード THE ゲームタイマーは プレイヤー名入力、経過時間表示、タイムアウト表示の全機能を提供すること
5. WHILE プレイヤー人数が2-3人 THE ゲームタイマーは 既存のレスポンシブレイアウト（スマートフォン、タブレット、PC）で正しく表示されること

### 要件3: ゲーム状態管理とバックエンド連携
**目的:** システムとして、2-6人のプレイヤー人数に対応したゲーム状態を正しく管理することで、データの整合性を保証する

#### 受入基準
1. WHEN フォールバックモードで2-6人のプレイヤー人数を設定 THEN ゲームタイマーは useGameStateで正しくプレイヤー配列を管理すること
2. WHEN APIモード（通常モード）で2-6人のプレイヤー人数を設定 THEN ゲームタイマーは useServerGameStateで正しくプレイヤー配列を管理すること
3. WHEN バックエンドAPIにプレイヤー人数2-6人のゲーム状態を送信 THEN バックエンドは 正しく受け入れて処理すること
4. IF バックエンドAPIが2人未満または7人以上のプレイヤー人数を受信 THEN バックエンドは バリデーションエラーを返すこと
5. WHEN ゲーム開始前にプレイヤー人数を変更 THEN ゲームタイマーは 全プレイヤーの時間を0にリセットすること

### 要件4: タイマー機能とゲーム制御の互換性
**目的:** ゲーム利用者として、2-3人のプレイヤー人数でも全てのタイマー機能が正常に動作することで、一貫したゲーム体験を得る

#### 受入基準
1. WHEN 2-3人でゲームを開始 THEN ゲームタイマーは ターン切り替え、一時停止、再開、リセットの全機能が正常に動作すること
2. WHEN 2-3人でカウントアップモードを使用 THEN ゲームタイマーは 各プレイヤーの経過時間を正しく計測すること
3. WHEN 2-3人でカウントダウンモードを使用 THEN ゲームタイマーは カウントダウン秒数設定とタイムアウト検知が正常に動作すること
4. WHEN 2-3人でゲームをプレイ中 THEN ゲームタイマーは 最長時間プレイヤー表示、ゲーム全体時間、ターン時間表示の全機能が正常に動作すること
5. WHEN 2-3人でゲームをプレイ中 THEN ゲームタイマーは ポーリング同期（5秒間隔）が正常に動作すること

### 要件5: プレイヤー名永続化の互換性
**目的:** ゲーム利用者として、2-6人のどのプレイヤー人数でもプレイヤー名履歴機能が正常に動作することで、スムーズなゲーム開始を実現する

#### 受入基準
1. WHEN 2-3人でプレイヤー名を入力 THEN ゲームタイマーは プレイヤー名をAzure Cosmos DB Table APIに保存すること
2. WHEN 2-3人でプレイヤー名入力欄をクリック THEN ゲームタイマーは 過去に使用したプレイヤー名をドロップダウンで表示すること
3. WHEN プレイヤー人数を4-6人から2-3人に変更 THEN ゲームタイマーは 減少したプレイヤー分のプレイヤー名入力欄を非表示にすること
4. WHEN プレイヤー人数を2-3人から4-6人に増加 THEN ゲームタイマーは 増加したプレイヤー分のプレイヤー名入力欄を表示すること

### 要件6: ゲーム開始前の制約
**目的:** システムとして、ゲーム開始後のプレイヤー人数変更を禁止することで、ゲーム進行中のデータ整合性を保証する

#### 受入基準
1. WHEN ゲームが開始されていない状態 THEN ゲームタイマーは プレイヤー人数選択ドロップダウンを有効化すること
2. WHEN ゲームが開始された状態 THEN ゲームタイマーは プレイヤー人数選択ドロップダウンを無効化すること
3. WHEN ゲームをリセット THEN ゲームタイマーは プレイヤー人数選択ドロップダウンを再度有効化すること
