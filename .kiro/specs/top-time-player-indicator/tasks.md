# 実装計画

## Phase 1: 最長時間プレイヤー計算ロジックの実装

- [ ] 1. 最長時間プレイヤー計算機能の実装
- [ ] 1.1 最長時間プレイヤー計算機能の実装
  - useGameStateフックに`getLongestTimePlayer()`メソッドを追加
  - 各プレイヤーの累計時間を比較し、最長時間のプレイヤーを特定
  - プレイヤー名と累計時間（時:分:秒形式）を返すロジック実装
  - 同点の場合は最初のプレイヤーを返す仕様
  - _要件: 1.1, 1.2, 1.3, 1.4, 1.5, 2.1_

- [ ] 1.2 リアルタイム更新対応
  - タイマー更新時に最長時間プレイヤーが自動的に再計算される仕組み
  - アクティブプレイヤーの時間更新時に即座に反映
  - ターン切り替え時の最長時間プレイヤー更新
  - カウントアップモード専用の動作確認
  - _要件: 3.1, 3.2, 3.3, 3.4_

- [ ] 1.3 ロジック層のテストと検証
  - TDD: 最長時間プレイヤー計算機能のテストケースを作成（RED phase）
  - 最小限の実装でテストをパス（GREEN phase）
  - 必要に応じてリファクタリング（REFACTOR phase）
  - エッジケース（全員同時間、1人のみ等）のテスト
  - `npm test`で全テストが成功することを確認
  - _要件: 1.1, 1.2, 1.3, 1.4, 1.5, 3.1, 3.2, 3.3, 3.4_

## Phase 2: 表示コンポーネントの実装

- [ ] 2. 表示コンポーネントの実装
- [ ] 2.1 最長時間プレイヤー表示コンポーネントの実装
  - TopTimePlayerIndicatorコンポーネントを新規作成
  - useGameStateから`getLongestTimePlayer()`を呼び出し
  - 「最も時間を使っているプレイヤー: ○○ (00:00:00)」形式で表示
  - プレイヤー名と時間を明確に表示するUI実装
  - カウントアップモード時のみ表示する条件付きレンダリング
  - _要件: 2.1, 2.2, 2.3, 2.4_

- [ ] 2.2 表示コンポーネントのテストと検証
  - TDD: TopTimePlayerIndicatorコンポーネントのテストケースを作成
  - 表示フォーマットが正しいことを検証
  - カウントアップ/カウントダウンモードの切り替え動作テスト
  - `npm test`で全テストが成功することを確認
  - _要件: 2.1, 2.2, 2.3, 2.4, 3.1, 3.2_

## Phase 3: スタイリングとレスポンシブ対応

- [ ] 3. スタイリングとレスポンシブ対応
- [ ] 3.1 視覚的に目立つスタイルの実装
  - プレイヤー名部分を太字で強調表示
  - 時間表示部分をモノスペースフォントで読みやすく
  - 背景色または枠線で他の情報と明確に区別
  - 視認性を高めるカラー設定
  - _要件: 2.1, 2.2, 2.3, 2.4_

- [ ] 3.2 レスポンシブレイアウトの実装
  - スマートフォン（375px）: コンパクト表示、フォントサイズ調整
  - タブレット（768px）: 中間サイズ最適化
  - PC（1024px以上）: ゆとりある表示
  - 全デバイスで読みやすいフォントサイズとレイアウト
  - _要件: 4.1, 4.2, 4.3, 4.4, 4.5_

## Phase 4: 統合テストと最終検証

- [ ] 4. 統合テストと最終検証
- [ ] 4.1 GameTimerへの統合
  - GameTimerコンポーネントにTopTimePlayerIndicatorを追加
  - 適切な位置に配置（別枠として明確に表示）
  - 既存のプレイヤー表示やコントロールと干渉しないレイアウト
  - カウントアップモード時のみ表示される条件実装
  - _要件: 1.1, 3.1, 3.2, 3.3, 3.4_

- [ ] 4.2 Chrome DevTools検証
  - Chrome DevTools MCPで全ての受入基準が満たされていることを検証
  - カウントアップモードでの最長時間プレイヤー表示確認
  - カウントダウンモードでの非表示確認
  - ターン切り替え時のリアルタイム更新確認
  - 各デバイスサイズ（375px、768px、1024px）での表示検証
  - プレイヤー名と時間の正確な表示確認
  - _要件: 全要件（1.1〜4.5）_

- [ ] 4.3 全受入基準の検証
  - 要件1の全受入基準（1.1〜1.5）が満たされていることを確認
  - 要件2の全受入基準（2.1〜2.4）が満たされていることを確認
  - 要件3の全受入基準（3.1〜3.4）が満たされていることを確認
  - 要件4の全受入基準（4.1〜4.5）が満たされていることを確認
  - すべてのテストが成功し、リグレッションがないことを確認
  - _要件: 全要件（1.1〜4.5）_

## 注意事項

### TDD実装プロセス（必須）
各タスクの実装時は以下のTDDプロセスに従うこと：
1. **RED phase**: 実装前にテストケースを作成
2. **GREEN phase**: 最小限の実装でテストをパス
3. **REFACTOR phase**: 必要に応じてリファクタリング
4. `npm test`で全テストが成功することを確認

### Chrome DevTools検証プロセス（必須）
実装完了後、以下の手順で実機検証を実施：
1. `npm run dev`で開発サーバー起動
2. `mcp__chrome-devtools__navigate_page`でアプリケーションにアクセス
3. `mcp__chrome-devtools__take_snapshot`で初期状態確認
4. 実装した機能の操作（`click`, `fill`, `evaluate_script`等）
5. 各操作後に`take_snapshot`で状態変化を確認
6. タイマー動作は`Bash(sleep N)`後にスナップショットで時間経過を確認

### タスク完了とコミットプロセス（必須）
検証完了後、以下を必ず実施：
1. `tasks.md`の該当タスクをチェック済み`[x]`に変更
2. 詳細なコミットメッセージでGitコミット作成
3. 即座にコミット（複数タスクをまとめない）

### 要件トレーサビリティ
- **要件1（最長時間プレイヤー表示）**: Task 1.1, 1.2, 2.1, 4.1, 4.2
- **要件2（表示フォーマット）**: Task 2.1, 3.1, 4.2
- **要件3（リアルタイム更新）**: Task 1.2, 4.1, 4.2
- **要件4（レスポンシブ表示）**: Task 3.2, 4.2
