# Requirements Document

## Introduction

本機能は、マルチプレイヤー・ゲームタイマーに2つの時間トラッキング機能を追加します：

1. **ターン時間トラッキング**: 各プレイヤーの現在のターンでの経過時間を、累計時間とは別に表示
2. **ゲーム全体のプレイ時間表示**: 全プレイヤーの累計時間の合計をゲーム全体のプレイ時間として表示

これにより、プレイヤーは自分の現在のターンでの時間使用状況を把握し、ゲーム全体の進行時間を確認できるようになります。特にボードゲームのような長時間のゲームセッションにおいて、時間管理の透明性が向上します。

**ビジネス価値**:
- プレイヤーは現在のターンでの時間使用を意識できる
- ゲーム進行の全体的な時間を把握し、終了時刻を予測できる
- 時間制限のあるゲームセッション（会場利用時間、イベントスケジュール等）での時間管理が容易になる

## Requirements

### Requirement 1: ターン時間の計測と表示

**目的**: プレイヤーとして、現在のターンでどれだけ時間を使用しているかを把握し、ターンの時間配分を最適化したい

#### Acceptance Criteria

1. WHEN アクティブプレイヤーが設定される THEN タイマーアプリケーション SHALL そのプレイヤーのターン開始時刻を記録する

2. WHEN アクティブプレイヤーが変更される THEN タイマーアプリケーション SHALL 前のアクティブプレイヤーのターン開始時刻をクリアする

3. WHILE プレイヤーがアクティブ状態 THE タイマーアプリケーション SHALL ターン開始時刻からの経過時間を1秒間隔で計算し続ける

4. WHEN ゲームが一時停止される THEN タイマーアプリケーション SHALL ターン時間の計測を停止する

5. WHEN ゲームが再開される THEN タイマーアプリケーション SHALL ターン時間の計測を再開する（一時停止中の時間を除外）

6. WHERE プレイヤーがアクティブ状態 THE タイマーアプリケーション SHALL そのプレイヤーカードに「現在のターン」表示領域を追加し、ターン経過時間をMM:SS形式で表示する

7. WHERE プレイヤーが非アクティブ状態 THE タイマーアプリケーション SHALL 「現在のターン」表示領域を非表示にする（または「-」を表示する）

8. WHEN ゲームがリセットされる THEN タイマーアプリケーション SHALL 全てのプレイヤーのターン時間計測をリセットする

### Requirement 2: ゲーム全体のプレイ時間表示

**目的**: プレイヤーとして、ゲームセッション全体でどれだけの時間が経過したかを把握し、残り時間を管理したい

#### Acceptance Criteria

1. WHERE ゲーム画面のヘッダーまたは固定表示領域 THE タイマーアプリケーション SHALL 「ゲーム全体のプレイ時間」表示領域を配置する

2. WHILE ゲームが進行中（一時停止でない状態） THE タイマーアプリケーション SHALL 全プレイヤーの累計経過時間の合計を1秒間隔で計算し続ける

3. WHEN 全プレイヤーの累計時間が更新される THEN タイマーアプリケーション SHALL ゲーム全体のプレイ時間をHH:MM:SS形式で表示する（1時間未満の場合はMM:SS形式）

4. WHEN ゲームが一時停止される THEN タイマーアプリケーション SHALL ゲーム全体のプレイ時間の計算を停止する（表示は維持）

5. WHEN ゲームが再開される THEN タイマーアプリケーション SHALL ゲーム全体のプレイ時間の計算を再開する

6. WHEN ゲームがリセットされる THEN タイマーアプリケーション SHALL ゲーム全体のプレイ時間を00:00にリセットする

7. WHEN プレイヤー数が変更される THEN タイマーアプリケーション SHALL 新しいプレイヤー構成でゲーム全体のプレイ時間を再計算する

### Requirement 3: UI統合とレスポンシブ対応

**目的**: プレイヤーとして、新しい時間情報を全てのデバイスで見やすく、既存のUIと調和した形で確認したい

#### Acceptance Criteria

1. WHERE プレイヤーカード THE タイマーアプリケーション SHALL 「現在のターン」表示を累計時間表示の下または横に配置する

2. WHERE ゲーム画面ヘッダー THE タイマーアプリケーション SHALL 「ゲーム全体のプレイ時間」を目立つ位置に配置する

3. WHEN 画面幅が768px以下（モバイル） THEN タイマーアプリケーション SHALL ターン時間とゲーム全体時間の表示を縦並びに配置する

4. WHEN 画面幅が768px超（タブレット・PC） THEN タイマーアプリケーション SHALL ターン時間とゲーム全体時間の表示を適切なグリッドレイアウトで配置する

5. WHERE ターン時間表示 THE タイマーアプリケーション SHALL アクティブプレイヤーであることを視覚的に示す強調表示を追加する（例：ハイライトカラー、アイコン）

6. WHERE ゲーム全体のプレイ時間表示 THE タイマーアプリケーション SHALL 時間の長さに応じて色を変更する（例：1時間未満は通常色、1-2時間は警告色、2時間以上は危険色）

### Requirement 4: データ構造とビジネスロジック

**目的**: 開発者として、既存のGameState型定義を拡張し、新機能の計算ロジックを正確に実装したい

#### Acceptance Criteria

1. WHEN GameState型が定義される THEN タイマーアプリケーション SHALL ターン開始時刻を保持する新しいフィールドを追加する

2. WHERE Player型定義 THE タイマーアプリケーション SHALL 現在のターンでの経過時間を計算するためのターン開始時刻フィールドを追加する

3. WHEN ターン時間が計算される THEN タイマーアプリケーション SHALL 現在時刻とターン開始時刻の差を秒単位で返す

4. WHEN ゲーム全体のプレイ時間が計算される THEN タイマーアプリケーション SHALL 全プレイヤーのelapsedTimeSecondsの合計を返す

5. IF カウントダウンモード THEN タイマーアプリケーション SHALL ゲーム全体のプレイ時間計算で初期時間からの減少分を考慮する

6. WHEN 一時停止状態が変更される THEN タイマーアプリケーション SHALL ターン開始時刻を調整し、一時停止中の時間を除外する

### Requirement 5: テスト可能性と検証

**目的**: 開発者として、新機能が正しく動作することを自動テストで検証したい

#### Acceptance Criteria

1. WHERE ユニットテスト THE タイマーアプリケーション SHALL ターン時間計算関数をテストするテストケースを提供する

2. WHERE ユニットテスト THE タイマーアプリケーション SHALL ゲーム全体のプレイ時間計算関数をテストするテストケースを提供する

3. WHERE E2Eテスト THE タイマーアプリケーション SHALL ターン時間表示が正しく更新されることを検証するテストシナリオを提供する

4. WHERE E2Eテスト THE タイマーアプリケーション SHALL ゲーム全体のプレイ時間表示が正しく更新されることを検証するテストシナリオを提供する

5. WHERE E2Eテスト THE タイマーアプリケーション SHALL 一時停止・再開時のターン時間の動作を検証するテストシナリオを提供する
